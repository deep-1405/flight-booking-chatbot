# Travel Flight Booking Assistant

A modern, AI-powered flight booking application with an intuitive conversational interface. This application uses Google Gemini AI to understand natural language travel queries and helps users search, compare, and book flights through an interactive web interface.

## ğŸŒŸ Features

- **AI-Powered Conversational Interface**: Natural language processing using Google Gemini 2.0 Flash
- **Voice Input Support**: Real-time voice transcription using AssemblyAI
- **Flight Search**: Search for one-way and round-trip flights
- **Airport Discovery**: Intelligent airport lookup with proximity-based suggestions
- **Interactive UI**: Modern Gradio-based interface with dark/light theme support
- **Flight Comparison**: View detailed flight information, prices, durations, and stops
- **Booking Integration**: Direct booking links to partner websites
- **RESTful API**: FastAPI backend with comprehensive flight search endpoints
- **Modular Architecture**: Clean separation of concerns with organized codebase

## ğŸ—ï¸ Architecture

The application follows a modular architecture:

```
flight-booking-chatbot/
â”œâ”€â”€ backend/          # FastAPI backend with routers, agents, and tools
â”œâ”€â”€ frontend/         # Gradio-based UI components
â”œâ”€â”€ shared_utils/     # Shared utilities (logging, data loading)
â””â”€â”€ flight_responses/ # Sample flight data and airport codes
```

### Components

- **Backend**: FastAPI application with routers for flights, airports, and geolocation
- **AI Agent**: LangGraph-based travel agent using Google Gemini
- **Tools**: Airport lookup and flight search tools integrated with SerpAPI
- **Frontend**: Gradio interface with voice transcription and interactive flight selection
- **Transcription**: AssemblyAI integration for voice-to-text conversion

## ğŸ› ï¸ Tech Stack

### Core Technologies
- **Python 3.12+**: Primary programming language
- **FastAPI**: Modern, fast web framework for building APIs
- **Gradio**: User-friendly interface for ML applications
- **LangGraph**: State machine framework for building AI agents
- **LangChain**: Framework for developing applications with LLMs

### AI & ML
- **Google Gemini 2.5 Flash**: Large language model for natural language understanding
- **AssemblyAI**: Real-time speech-to-text transcription

### APIs & Services
- **SerpAPI**: Google Flights search integration
- **Google Search Results**: Additional search capabilities

### Dependencies
- **uvicorn**: ASGI server for FastAPI
- **httpx**: Async HTTP client
- **pydantic**: Data validation
- **python-dotenv**: Environment variable management
- **pyaudio**: Audio input for voice transcription

## ğŸ“¦ Installation

### Prerequisites

- Python 3.12 or higher
- `uv` package manager (recommended) or `pip`
- API keys for:
  - Google Gemini API
  - SerpAPI
  - AssemblyAI (for voice transcription)
  - Google Geolocation API
  - Amadeus Key
  - Amadeus Secret

### Setup Steps

1. **Clone the repository**
   ```bash
   git clone https://github.com/deep-1405/flight-booking-chatbot.git
   cd flight-booking-chatbot
   ```

2. **Install dependencies using uv (recommended)**
   ```bash
   uv sync
   ```

   Or using pip:
   ```bash
   pip install -e .
   ```

3. **Set up environment variables**
   
   Create a `.env` file in the root directory:
   ```env
   google_api_key=your_google_gemini_api_key
   SERPAPI_API_KEY=your_serpapi_key
   ASSEMBLYAI_API_KEY=your_assemblyai_key
   ```

## ğŸš€ Usage

### Running the Application

1. **Start the FastAPI backend** (in one terminal):
   ```bash
   python -m backend.main
   ```
   The API will be available at `http://localhost:8000`

2. **Start the Gradio frontend** (in another terminal):
   ```bash
   python -m frontend.main
   ```
   The UI will be available at `http://localhost:7860` (or the URL shown in the terminal)

### Using the Application

1. **Text Input**: Type your travel query in natural language, e.g.:
   - "I want to fly from New York to London on March 15th"
   - "Find flights from Mumbai to Delhi for 2 adults on 2024-12-20"
   - "Show me round trip flights from Paris to Tokyo leaving on May 1st and returning on May 15th"

2. **Voice Input**: Click the microphone button (ğŸ¤) to start voice recording, then click again to stop and transcribe

3. **Flight Selection**: 
   - Browse available flights in the interactive cards
   - Click on a flight card to view detailed information
   - For round trips, select outbound flight first, then return flight

4. **Booking**: 
   - Click "Finalise Flight" after selecting your preferred flight
   - Review booking options from different partners
   - Click "Book" to get redirected to the booking partner's website

## ğŸ“¡ API Documentation

### FastAPI Endpoints

Once the backend is running, visit `http://localhost:8000/docs` for interactive API documentation.

#### Main Endpoints

- **GET `/api/outbound-flights`**: Search for outbound flights
  - Query parameters: `departure_id`, `arrival_id`, `outbound_date`, `adults`, `children`, `return_date`
  
- **GET `/api/return-flights`**: Search for return flights (round trip)
  - Query parameters: `departure_id`, `arrival_id`, `outbound_date`, `return_date`, `adults`, `children`, `departure_token`
  
- **GET `/api/bookingdata`**: Get booking options for selected flights
  - Query parameters: `departure_id`, `arrival_id`, `outbound_date`, `adults`, `children`, `return_date`, `booking_token`

- **GET `/api/airports`**: Search for airports by location
- **GET `/api/geolocation`**: Get geolocation data for locations

### API Workflow

1. **One-Way Flights**:
   - Call `/api/outbound-flights` â†’ Get `booking_token`
   - Call `/api/bookingdata` with `booking_token` â†’ Get booking options

2. **Round-Trip Flights**:
   - Call `/api/outbound-flights` with `return_date` â†’ Get `departure_token`
   - Call `/api/return-flights` with `departure_token` â†’ Get `booking_token`
   - Call `/api/bookingdata` with `booking_token` â†’ Get booking options

## ğŸ“ Project Structure

```
flight-booking-chatbot/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â””â”€â”€ travel_agent.py      # LangGraph-based AI travel agent
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”œâ”€â”€ flights.py            # Flight search API endpoints
â”‚   â”‚   â”œâ”€â”€ airports.py           # Airport lookup endpoints
â”‚   â”‚   â””â”€â”€ geolocation.py        # Geolocation endpoints
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ flights.py            # Flight search tool for AI agent
â”‚   â”‚   â””â”€â”€ airports.py           # Airport lookup tool for AI agent
â”‚   â”œâ”€â”€ transcript/
â”‚   â”‚   â””â”€â”€ main.py               # AssemblyAI transcription service
â”‚   â”œâ”€â”€ utils.py                 # Backend utility functions
â”‚   â””â”€â”€ main.py                   # FastAPI application entry point
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ ui_manager.py        # UI state management and updates
â”‚   â”œâ”€â”€ images/                  # UI assets (icons, etc.)
â”‚   â”œâ”€â”€ utils.py                 # Frontend utility functions
â”‚   â””â”€â”€ main.py                   # Gradio application entry point
â”œâ”€â”€ shared_utils/
â”‚   â”œâ”€â”€ logger.py                # JSON-formatted logging utility
â”‚   â””â”€â”€ load_data.py             # Shared data loading utilities
â”œâ”€â”€ flight_responses/            # Sample flight data and test responses
â”œâ”€â”€ pyproject.toml               # Project dependencies and metadata
â”œâ”€â”€ uv.lock                      # Dependency lock file
â””â”€â”€ README.md                    # This file
```

## ğŸ”§ Configuration

### Environment Variables

| Variable | Description |
|----------|-------------|
| `google_api_key` | Google Gemini API key |
| `SERPAPI_API_KEY` | SerpAPI key for flight searches |
| `ASSEMBLYAI_API_KEY` | AssemblyAI key for voice transcription |
| `GOOGLE_GEOLOCATION_API` | Google Geolocation API key for location-based services |
| `AMADEUS_CLIENT_ID` | Amadeus API client ID for flight booking services |
| `AMADEUS_CLIENT_SECRET` | Amadeus API client secret for flight booking services |

### API Configuration

The application uses the following default settings:
- **Currency**: INR (Indian Rupees)
- **Language**: English (en)
- **Country**: India (in)
- **Deep Search**: Enabled for comprehensive flight results

```

### Code Structure

- **Modular Design**: Each component (backend, frontend, shared_utils) is self-contained
- **Type Safety**: Uses Pydantic models for data validation
- **Async/Await**: Backend uses async/await for better performance
- **State Management**: LangGraph for AI agent state, Gradio State for UI state

### Logging

The application uses JSON-formatted logging. Logs are output to stdout with the following structure:
```json
{
  "timestamp": "2024-01-01 12:00:00.000",
  "message": "Log message",
  "module": "module_name",
  "line": 123
}
```

## ğŸ™ Acknowledgments

- Google Gemini for AI capabilities
- SerpAPI for flight search integration
- AssemblyAI for voice transcription
- Gradio for the user interface framework
- LangChain and LangGraph for AI agent framework

## ğŸ“ Support

For issues, questions, or contributions, please open an issue on the repository.

---